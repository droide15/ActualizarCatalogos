using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using MySql.Data.MySqlClient;

        static void Main(string[] args)
        {
            string cs = @"server=mysql4.gear.host;userid=programamestadb;
            password=Ot0S2-PVBA~A;database=programamestadb";

            MySqlConnection conn = null;
            connect(cs, ref conn);

                    insertarDatos(ref conn, tabla, atribs, datos);

            close(ref conn);
        }

        //insertando datos en una tabla
        protected static void insertarDatos(ref MySqlConnection conn, string tabla, List<string> atribs, List<string> datos)
        {
            try
            {
                MySqlCommand cmd = new MySqlCommand();
                List<string> campos = new List<string>();
                for (int i = 0; i < atribs.Count; i++)
                {
                    campos.Add("@" + atribs.ElementAt(i));
                }
                string lista_atribs = string.Join(",", atribs.ToArray());
                string lista_campos = string.Join(",", campos.ToArray());

                cmd.Connection = conn;
                cmd.CommandText = "INSERT INTO " + tabla + "(" + lista_atribs + ") VALUES(" + lista_campos + ")";
                cmd.Prepare();
                for (int i = 0; i < atribs.Count; i++)
                {
                    cmd.Parameters.AddWithValue(campos.ElementAt(i), datos.ElementAt(i));
                }
                cmd.ExecuteNonQuery();
            }
            catch (MySqlException ex)
            {
                Console.WriteLine("Error: {0}", ex.ToString());
            }
        }
